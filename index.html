<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
    <meta name="theme-color" content="#0277bd" />
    <meta name="description" content="Simple ToDo - Ad-free Task Manager" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    
    <title>Simple ToDo</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json" />
    
    <!-- Icons -->
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/7692/7692809.png" />
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/7692/7692809.png" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for in-browser JSX compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              app: {
                header: '#0277bd',
                bg: '#013e6b',
                card: '#02588e',
                accent: '#ffffff',
                subtext: '#81d4fa',
                overdue: '#ff5252',
                fab: '#ffffff',
              }
            }
          }
        }
      }
    </script>
    <style>
      .no-scrollbar::-webkit-scrollbar { display: none; }
      .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      body {
        background-color: #013e6b;
        color: white;
        overscroll-behavior-y: none;
        -webkit-tap-highlight-color: transparent;
        font-family: sans-serif;
      }
      /* Date picker dark mode fix */
      ::-webkit-calendar-picker-indicator { filter: invert(1); cursor: pointer; }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.555.0"
  }
}
</script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // --- ICONS (Inline SVGs to avoid dependencies) ---
      const IconBase = ({ d, className, fill = "none", strokeWidth = 2 }) => (
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}>
          {d}
        </svg>
      );

      const Icons = {
        Menu: () => <IconBase d={<><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></>} className="w-6 h-6 text-white" />,
        Search: () => <IconBase d={<><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></>} className="w-6 h-6 text-white" />,
        More: () => <IconBase d={<><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></>} className="w-6 h-6 text-white" />,
        Mic: () => <IconBase d={<path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="22"/>} className="w-5 h-5 text-gray-300" />,
        Plus: () => <IconBase d={<><path d="M5 12h14"/><path d="M12 5v14"/></>} className="w-8 h-8 text-app-header" />,
        Back: () => <IconBase d={<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>} className="w-6 h-6 text-white" />,
        Check: () => <IconBase d={<path d="M20 6 9 17l-5-5"/>} className="w-6 h-6 text-white" />,
        Calendar: () => <IconBase d={<><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></>} className="w-5 h-5 text-gray-300" />,
        List: () => <IconBase d={<><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></>} className="w-6 h-6" />,
        Settings: () => <IconBase d={<path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/>} className="w-6 h-6" />,
        Share: () => <IconBase d={<circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"/><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"/>} className="w-6 h-6" />,
        Rate: () => <IconBase d={<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>} className="w-6 h-6" />,
        Feedback: () => <IconBase d={<path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>} className="w-6 h-6" />,
        Close: () => <IconBase d={<path d="M18 6 6 18"/><path d="m6 6 12 12"/>} className="w-6 h-6 text-white" />,
        Save: () => <IconBase d={<path d="M20 6 9 17l-5-5"/>} className="w-8 h-8 text-app-header" strokeWidth={3} />,
        CheckboxUnchecked: () => (
          <div className="w-6 h-6 border-2 border-gray-300 rounded-sm" />
        ),
        CheckboxChecked: () => (
          <div className="w-6 h-6 bg-app-header border-2 border-app-header rounded-sm flex items-center justify-center">
            <IconBase d={<path d="M20 6 9 17l-5-5"/>} className="w-4 h-4 text-white" strokeWidth={3} />
          </div>
        )
      };

      // --- COMPONENTS ---

      // Header Component
      const Header = ({ title, onMenuClick, onBackClick, isMainView = true }) => {
        return (
          <div className="h-14 bg-app-header flex items-center px-4 shadow-md z-30 shrink-0 sticky top-0">
            <button 
              onClick={isMainView ? onMenuClick : onBackClick}
              className="p-2 -ml-2 rounded-full hover:bg-white/10 active:bg-white/20"
            >
              {isMainView ? <Icons.Menu /> : <Icons.Back />}
            </button>
            
            <div className="flex-1 ml-4">
              {isMainView ? (
                <div className="flex items-center cursor-pointer">
                   <span className="text-xl font-bold text-white mr-1">{title}</span>
                   <div className="w-0 h-0 border-l-[5px] border-l-transparent border-r-[5px] border-r-transparent border-t-[6px] border-t-white mt-1"></div>
                </div>
              ) : (
                <h1 className="text-xl font-bold text-white">{title}</h1>
              )}
            </div>

            {isMainView && (
              <div className="flex items-center space-x-1">
                <button className="p-2 rounded-full hover:bg-white/10 active:bg-white/20">
                  <Icons.Search />
                </button>
                <button className="p-2 rounded-full hover:bg-white/10 active:bg-white/20">
                  <Icons.More />
                </button>
              </div>
            )}
          </div>
        );
      };

      // Sidebar Component
      const Sidebar = ({ isOpen, onClose, onNavigate }) => {
        const overlayClass = isOpen ? "opacity-50 pointer-events-auto" : "opacity-0 pointer-events-none";
        const drawerClass = isOpen ? "translate-x-0" : "-translate-x-full";

        const handleNav = (view) => {
          onNavigate(view);
          onClose();
        };

        const menuItems = [
          { icon: <Icons.List />, label: 'Task Lists', action: () => handleNav('LIST') },
          { icon: <Icons.List />, label: 'Add in Batch Mode', action: () => {} },
          { icon: <Icons.List />, label: 'Remove Ads', action: () => {}, subtext: "Paid" },
          { icon: <Icons.Share />, label: 'More Apps', action: () => {} },
          { icon: <Icons.Feedback />, label: 'Send feedback', action: () => {} },
          { icon: <Icons.Rate />, label: 'Follow us', action: () => {} },
          { icon: <Icons.Share />, label: 'Invite friends to the app', action: () => {} },
          { icon: <Icons.Settings />, label: 'Settings', action: () => handleNav('SETTINGS') },
        ];

        return (
          <>
            <div 
              className={`fixed inset-0 bg-black transition-opacity duration-300 z-40 ${overlayClass}`}
              onClick={onClose}
            />
            <div className={`fixed inset-y-0 left-0 w-[80%] max-w-[300px] bg-app-header shadow-2xl transform transition-transform duration-300 z-50 flex flex-col ${drawerClass}`}>
              <div className="p-4 bg-app-bg text-white border-b border-white/10 pt-10">
                <h2 className="text-xl font-bold">All Lists</h2>
                <div className="flex items-center mt-2 text-sm text-app-subtext cursor-pointer">
                  <span>Default</span>
                </div>
              </div>
              <div className="flex-1 overflow-y-auto bg-app-header py-2">
                {menuItems.map((item, idx) => (
                  <button 
                    key={idx}
                    onClick={item.action}
                    className="w-full flex items-center px-4 py-3 text-left hover:bg-white/10 active:bg-white/20 transition-colors"
                  >
                    <div className="text-white/80 mr-4">{item.icon}</div>
                    <div className="flex-1">
                      <span className="text-white text-[15px] font-medium block">{item.label}</span>
                    </div>
                  </button>
                ))}
              </div>
            </div>
          </>
        );
      };

      // TaskItem Component
      const TaskItem = ({ task, onToggle }) => {
        const getFormattedDate = (dateStr) => {
          const date = new Date(dateStr);
          return date.toLocaleDateString('en-GB', { weekday: 'short', day: 'numeric', month: 'short', year: 'numeric' });
        };
        const isOverdue = task.dueDate && new Date(task.dueDate) < new Date(new Date().setHours(0,0,0,0));

        return (
          <div className="bg-app-card rounded-lg p-3 mb-2 flex items-start shadow-sm border-l-4 border-transparent hover:border-l-4 hover:border-blue-400 transition-all active:scale-[0.99]">
            <button 
              onClick={(e) => {
                e.stopPropagation();
                onToggle(task.id);
              }}
              className="mt-1 mr-3 shrink-0"
            >
              {task.isCompleted ? <Icons.CheckboxChecked /> : <Icons.CheckboxUnchecked />}
            </button>
            <div className="flex-1 min-w-0">
              <h3 className={`text-[16px] text-white leading-tight ${task.isCompleted ? 'line-through opacity-70' : ''}`}>
                {task.title}
              </h3>
              {task.dueDate && (
                <p className={`text-xs mt-1 ${isOverdue && !task.isCompleted ? 'text-app-overdue' : 'text-app-overdue/80'}`}>
                  {getFormattedDate(task.dueDate)}
                </p>
              )}
            </div>
          </div>
        );
      };

      // SettingsScreen Component
      const SettingsItem = ({ title, subtitle, hasCheckbox, checked }) => (
        <div className="px-4 py-4 flex items-center justify-between active:bg-white/5 border-b border-white/5">
          <div className="flex-1 pr-4">
            <div className="text-white text-[16px] font-normal">{title}</div>
            {subtitle && <div className="text-gray-400 text-sm mt-0.5">{subtitle}</div>}
          </div>
          {hasCheckbox && (
            <div className={`w-5 h-5 border-2 rounded-sm flex items-center justify-center ${checked ? 'bg-app-header border-app-header' : 'border-gray-400'}`}>
              {checked && <Icons.Check className="w-3.5 h-3.5" />}
            </div>
          )}
        </div>
      );

      const SectionHeader = ({ title }) => (
        <div className="px-4 pt-6 pb-2 text-app-header font-bold text-sm uppercase tracking-wide">
          {title}
        </div>
      );

      const SettingsScreen = ({ onBack }) => {
        return (
          <div className="flex flex-col h-screen bg-app-bg overflow-y-auto no-scrollbar pb-20">
            <Header title="Settings" isMainView={false} onBackClick={onBack} />
            
            <SectionHeader title="General" />
            <SettingsItem title="Remove Ads" subtitle="One payment to remove ads forever." />
            <SettingsItem title="Status bar" subtitle="Enabled" hasCheckbox checked />
            <SettingsItem title="Confirm finishing tasks" subtitle="Disabled" hasCheckbox />
            <SettingsItem title="Confirm repeating tasks" subtitle="Disabled" hasCheckbox />
            <SettingsItem title="Found in clipboard" subtitle="Enabled" hasCheckbox checked />
            <SettingsItem title="List to show at startup" subtitle="All Lists" />
            <SettingsItem title="First day of week" subtitle="Monday" />
            <SettingsItem title="Time format" subtitle="24-hour" />
            <SettingsItem title="Sort order" subtitle="Due date + Alphabetically" />

            <SectionHeader title="Notifications" />
            <SettingsItem title="Sound" subtitle="Default (Eureka)" />
            <SettingsItem title="Voice" subtitle="Uses system default speech synthesizer (TTS)" hasCheckbox checked />
            <SettingsItem title="Vibration" subtitle="Enabled" hasCheckbox checked />
            <SettingsItem title="Task notification" subtitle="On time" />
            <SettingsItem title="Day summary" subtitle="Enabled" hasCheckbox checked />
            <SettingsItem title="Choose time" subtitle="8:00" />

            <SectionHeader title="About" />
            <SettingsItem title="Invite friends to the app" />
            <SettingsItem title="More Apps" />
            <SettingsItem title="Send feedback" />
            <div className="h-10"></div>
          </div>
        );
      };

      // MAIN APP COMPONENT
      function App() {
        const [view, setView] = useState('LIST');
        const [isSidebarOpen, setIsSidebarOpen] = useState(false);
        const [tasks, setTasks] = useState([]);
        const [quickTaskTitle, setQuickTaskTitle] = useState('');
        const [newTaskTitle, setNewTaskTitle] = useState('');
        const [newTaskDate, setNewTaskDate] = useState('');

        useEffect(() => {
          const saved = localStorage.getItem('simple-todo-tasks');
          if (saved) {
            try { setTasks(JSON.parse(saved)); } catch (e) {}
          } else {
            const today = new Date().toISOString().split('T')[0];
            const tomorrow = new Date(Date.now() + 86400000).toISOString().split('T')[0];
            setTasks([
              { id: '1', title: 'Welcome to your new ad-free list!', dueDate: today, isCompleted: false, listId: 'default', createdAt: Date.now() },
              { id: '2', title: 'Swipe right or tap box to complete', dueDate: tomorrow, isCompleted: false, listId: 'default', createdAt: Date.now() },
              { id: '3', title: 'Check settings for customization options', dueDate: null, isCompleted: false, listId: 'default', createdAt: Date.now() },
            ]);
          }
        }, []);

        useEffect(() => {
          localStorage.setItem('simple-todo-tasks', JSON.stringify(tasks));
        }, [tasks]);

        const handleQuickAdd = (e) => {
          e.preventDefault();
          if (!quickTaskTitle.trim()) return;
          
          const newTask = {
            id: Date.now().toString(),
            title: quickTaskTitle,
            dueDate: null,
            isCompleted: false,
            listId: 'default',
            createdAt: Date.now()
          };
          
          setTasks([...tasks, newTask]);
          setQuickTaskTitle('');
        };

        const handleDetailedAdd = () => {
          if (!newTaskTitle.trim()) return;
          const newTask = {
            id: Date.now().toString(),
            title: newTaskTitle,
            dueDate: newTaskDate || null,
            isCompleted: false,
            listId: 'default',
            createdAt: Date.now()
          };
          setTasks([...tasks, newTask]);
          setNewTaskTitle('');
          setNewTaskDate('');
          setView('LIST');
        };

        const toggleTask = (id) => {
          setTasks(tasks.map(t => t.id === id ? { ...t, isCompleted: !t.isCompleted } : t));
        };

        const getGroupedTasks = () => {
          const now = new Date();
          const todayStr = now.toISOString().split('T')[0];
          const nowTime = now.setHours(0,0,0,0);
          const overdue = [], today = [], later = [], noDate = [], completed = [];

          tasks.forEach(task => {
            if (task.isCompleted) { completed.push(task); return; }
            if (!task.dueDate) { noDate.push(task); return; }
            const taskDate = new Date(task.dueDate).setHours(0,0,0,0);
            if (task.dueDate === todayStr) today.push(task);
            else if (taskDate < nowTime) overdue.push(task);
            else later.push(task);
          });
          return { overdue, today, later, noDate, completed };
        };

        const grouped = getGroupedTasks();
        const renderSection = (title, groupTasks, titleColorClass = 'text-app-overdue') => {
          if (groupTasks.length === 0) return null;
          return (
            <div className="mb-4">
              <h2 className={`text-sm font-bold mb-2 ${titleColorClass}`}>{title}</h2>
              {groupTasks.map(t => <TaskItem key={t.id} task={t} onToggle={toggleTask} />)}
            </div>
          );
        };

        if (view === 'SETTINGS') return <SettingsScreen onBack={() => setView('LIST')} />;

        if (view === 'NEW_TASK') {
          return (
            <div className="flex flex-col h-screen bg-app-bg">
              <Header title="New Task" isMainView={false} onBackClick={() => setView('LIST')} />
              <div className="p-4 flex-1">
                <div className="mb-6">
                  <label className="block text-app-subtext text-sm font-bold mb-1">What is to be done?</label>
                  <input 
                    type="text" autoFocus
                    className="w-full bg-transparent border-b-2 border-app-subtext text-white text-lg py-1 focus:outline-none focus:border-white placeholder-white/30"
                    placeholder="Enter Task Here"
                    value={newTaskTitle}
                    onChange={(e) => setNewTaskTitle(e.target.value)}
                  />
                  <div className="flex justify-end mt-2"><Icons.Mic /></div>
                </div>
                <div className="mb-6">
                  <label className="block text-app-subtext text-sm font-bold mb-1">Due date</label>
                  <div className="flex items-center border-b border-gray-500 py-2">
                     <input type="date" className="bg-transparent text-white w-full focus:outline-none [color-scheme:dark]"
                      value={newTaskDate} onChange={(e) => setNewTaskDate(e.target.value)} />
                     <Icons.Calendar />
                  </div>
                  <p className="text-xs text-app-subtext mt-1">{!newTaskDate ? "Date not set" : "Notifications will occur on this date"}</p>
                </div>
                 <div className="mb-6">
                  <label className="block text-app-subtext text-sm font-bold mb-1">Add to List</label>
                  <div className="flex justify-between items-center py-2"><span className="text-white text-lg">Default</span></div>
                </div>
              </div>
              <div className="absolute bottom-6 right-6">
                <button onClick={handleDetailedAdd} className="w-14 h-14 bg-white rounded-full shadow-lg flex items-center justify-center active:scale-95 transition-transform">
                  <Icons.Save /> 
                </button>
              </div>
            </div>
          );
        }

        return (
          <div className="flex flex-col h-screen bg-app-bg text-white overflow-hidden relative">
            <Sidebar isOpen={isSidebarOpen} onClose={() => setIsSidebarOpen(false)} onNavigate={(v) => { setView(v); setIsSidebarOpen(false); }} />
            <Header title="All Lists" onMenuClick={() => setIsSidebarOpen(true)} />
            <div className="flex-1 overflow-y-auto p-4 pb-24 no-scrollbar">
              {renderSection("Overdue", grouped.overdue, 'text-app-overdue')}
              {renderSection("Today", grouped.today, 'text-green-400')}
              {renderSection("Later", grouped.later, 'text-gray-300')}
              {renderSection("No date", grouped.noDate, 'text-gray-400')}
              {grouped.completed.length > 0 && (
                 <div className="mt-8 border-t border-white/10 pt-4 opacity-60">
                   <h2 className="text-sm font-bold mb-2 text-gray-400">Completed</h2>
                   {grouped.completed.map(t => <TaskItem key={t.id} task={t} onToggle={toggleTask} />)}
                 </div>
              )}
            </div>
            <div className="absolute bottom-0 left-0 right-0 z-20">
              <div className="absolute right-4 bottom-20">
                <button onClick={() => setView('NEW_TASK')} className="w-14 h-14 bg-app-fab rounded-full shadow-lg flex items-center justify-center active:scale-95 transition-transform">
                  <Icons.Plus />
                </button>
              </div>
              <div className="bg-[#024b7a] p-2 flex items-center shadow-lg border-t border-white/5">
                <form onSubmit={handleQuickAdd} className="flex-1 flex items-center bg-transparent px-2">
                   <div className="mr-3"><Icons.Plus /></div>
                   <input type="text" className="flex-1 bg-transparent text-white placeholder-gray-400 focus:outline-none py-3 text-[16px]" placeholder="Enter Quick Task Here"
                     value={quickTaskTitle} onChange={(e) => setQuickTaskTitle(e.target.value)} />
                   <button type="button" className="p-2"><Icons.Mic /></button>
                </form>
              </div>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
</body>
</html>
